import{r as F,c as q,g as ie,aB as se,ae as de,aw as fe,h as m,a5 as me,a7 as ge,N as _e,t as be,bg as he,w as Fe,z as ye,b as ze,aP as qe,aN as Se,Q as ne,ad as we,W as J,p as ke,aM as xe,l as Ue,m as Be,n as Ce,P as M,f as K,bh as H}from"./index.a5b05cd4.js";import{Q as De}from"./QCircularProgress.5099a7a2.js";import{h as ue}from"./format.461987d7.js";import{Q as Te}from"./QTable.4f59c1c4.js";import{Q as Re}from"./QPage.b3031da7.js";import"./QList.eea01ad0.js";import"./QSelect.31a4a61e.js";import"./QField.c93c9e13.js";function $(n,v,o,l){const u=[];return n.forEach(p=>{l(p)===!0?u.push(p):v.push({failedPropValidation:o,file:p})}),u}function X(n){n&&n.dataTransfer&&(n.dataTransfer.dropEffect="copy"),de(n)}const Pe={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ee=["rejected"];function Le({editable:n,dnd:v,getFileInput:o,addFilesToQueue:l}){const{props:u,emit:p,proxy:b}=ie(),k=F(null),N=q(()=>u.accept!==void 0?u.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),D=q(()=>parseInt(u.maxFiles,10)),T=q(()=>parseInt(u.maxTotalSize,10));function j(t){if(n.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&se(t);else{const y=o();y&&y!==t.target&&y.click(t)}}function R(t){n.value&&t&&l(null,t)}function P(t,y,E,L){let i=Array.from(y||t.target.files);const f=[],w=()=>{f.length!==0&&p("rejected",f)};if(u.accept!==void 0&&N.value.indexOf("*/")===-1&&(i=$(i,f,"accept",s=>N.value.some(_=>s.type.toUpperCase().startsWith(_)||s.name.toUpperCase().endsWith(_))),i.length===0))return w();if(u.maxFileSize!==void 0){const s=parseInt(u.maxFileSize,10);if(i=$(i,f,"max-file-size",_=>_.size<=s),i.length===0)return w()}if(u.multiple!==!0&&i.length!==0&&(i=[i[0]]),i.forEach(s=>{s.__key=s.webkitRelativePath+s.lastModified+s.name+s.size}),L===!0){const s=E.map(_=>_.__key);i=$(i,f,"duplicate",_=>s.includes(_.__key)===!1)}if(i.length===0)return w();if(u.maxTotalSize!==void 0){let s=L===!0?E.reduce((_,U)=>_+U.size,0):0;if(i=$(i,f,"max-total-size",_=>(s+=_.size,s<=T.value)),i.length===0)return w()}if(typeof u.filter=="function"){const s=u.filter(i);i=$(i,f,"filter",_=>s.includes(_))}if(u.maxFiles!==void 0){let s=L===!0?E.length:0;if(i=$(i,f,"max-files",()=>(s++,s<=D.value)),i.length===0)return w()}if(w(),i.length!==0)return i}function e(t){X(t),v.value!==!0&&(v.value=!0)}function g(t){de(t),(t.relatedTarget!==null||fe.is.safari!==!0?t.relatedTarget!==k.value:document.elementsFromPoint(t.clientX,t.clientY).includes(k.value)===!1)===!0&&(v.value=!1)}function S(t){X(t);const y=t.dataTransfer.files;y.length!==0&&l(null,y),v.value=!1}function c(t){if(v.value===!0)return m("div",{ref:k,class:`q-${t}__dnd absolute-full`,onDragenter:X,onDragover:X,onDragleave:g,onDrop:S})}return Object.assign(b,{pickFiles:j,addFiles:R}),{pickFiles:j,addFiles:R,onDragover:e,onDragleave:g,processFiles:P,getDndNode:c,maxFilesNumber:D,maxTotalSizeNumber:T}}function re(n){return(n*100).toFixed(2)+"%"}const je={...me,...Pe,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},ce=[...Ee,"start","finish","added","removed"];function Ae(n,v){const o=ie(),{props:l,slots:u,emit:p,proxy:b}=o,{$q:k}=b,N=ge(l,k);function D(a,d,h){if(a.__status=d,d==="idle"){a.__uploaded=0,a.__progress=0,a.__sizeLabel=ue(a.size),a.__progressLabel="0.00%";return}if(d==="failed"){b.$forceUpdate();return}a.__uploaded=d==="uploaded"?a.size:h,a.__progress=d==="uploaded"?1:Math.min(.9999,a.__uploaded/a.size),a.__progressLabel=re(a.__progress),b.$forceUpdate()}const T=q(()=>l.disable!==!0&&l.readonly!==!0),j=F(!1),R=F(null),P=F(null),e={files:F([]),queuedFiles:F([]),uploadedFiles:F([]),uploadedSize:F(0),updateFileStatus:D,isAlive:()=>_e(o)===!1},{pickFiles:g,addFiles:S,onDragover:c,onDragleave:t,processFiles:y,getDndNode:E,maxFilesNumber:L,maxTotalSizeNumber:i}=Le({editable:T,dnd:j,getFileInput:ee,addFilesToQueue:ae});Object.assign(e,n({props:l,slots:u,emit:p,helpers:e,exposeApi:a=>{Object.assign(e,a)}})),e.isBusy===void 0&&(e.isBusy=F(!1));const f=F(0),w=q(()=>f.value===0?0:e.uploadedSize.value/f.value),s=q(()=>re(w.value)),_=q(()=>ue(f.value)),U=q(()=>T.value===!0&&e.isUploading.value!==!0&&(l.multiple===!0||e.queuedFiles.value.length===0)&&(l.maxFiles===void 0||e.files.value.length<L.value)&&(l.maxTotalSize===void 0||f.value<i.value)),r=q(()=>T.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);be(he,le);const A=q(()=>"q-uploader column no-wrap"+(N.value===!0?" q-uploader--dark q-dark":"")+(l.bordered===!0?" q-uploader--bordered":"")+(l.square===!0?" q-uploader--square no-border-radius":"")+(l.flat===!0?" q-uploader--flat no-shadow":"")+(l.disable===!0?" disabled q-uploader--disable":"")+(j.value===!0?" q-uploader--dnd":"")),O=q(()=>"q-uploader__header"+(l.color!==void 0?` bg-${l.color}`:"")+(l.textColor!==void 0?` text-${l.textColor}`:""));Fe(e.isUploading,(a,d)=>{d===!1&&a===!0?p("start"):d===!0&&a===!1&&p("finish")});function I(){l.disable===!1&&(e.abort(),e.uploadedSize.value=0,f.value=0,Z(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function x(){l.disable===!1&&V(["uploaded"],()=>{e.uploadedFiles.value=[]})}function Y(){V(["idle","failed"],({size:a})=>{f.value-=a,e.queuedFiles.value=[]})}function V(a,d){if(l.disable===!0)return;const h={files:[],size:0},B=e.files.value.filter(z=>a.indexOf(z.__status)===-1?!0:(h.size+=z.size,h.files.push(z),z.__img!==void 0&&window.URL.revokeObjectURL(z.__img.src),!1));h.files.length!==0&&(e.files.value=B,d(h),p("removed",h.files))}function G(a){l.disable||(a.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(d=>d.__key!==a.__key):a.__status==="uploading"?a.__abort():f.value-=a.size,e.files.value=e.files.value.filter(d=>d.__key!==a.__key?!0:(d.__img!==void 0&&window.URL.revokeObjectURL(d.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(d=>d.__key!==a.__key),p("removed",[a]))}function Z(){e.files.value.forEach(a=>{a.__img!==void 0&&window.URL.revokeObjectURL(a.__img.src)})}function ee(){return P.value||R.value.getElementsByClassName("q-uploader__input")[0]}function ae(a,d){const h=y(a,d,e.files.value,!0),B=ee();B!=null&&(B.value=""),h!==void 0&&(h.forEach(z=>{if(e.updateFileStatus(z,"idle"),f.value+=z.size,l.noThumbnails!==!0&&z.type.toUpperCase().startsWith("IMAGE")){const oe=new Image;oe.src=window.URL.createObjectURL(z),z.__img=oe}}),e.files.value=e.files.value.concat(h),e.queuedFiles.value=e.queuedFiles.value.concat(h),p("added",h),l.autoUpload===!0&&e.upload())}function te(){r.value===!0&&e.upload()}function W(a,d,h){if(a===!0){const B={type:"a",key:d,icon:k.iconSet.uploader[d],flat:!0,dense:!0};let z;return d==="add"?(B.onClick=g,z=le):B.onClick=h,m(J,B,z)}}function le(){return m("input",{ref:P,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:l.accept,multiple:l.multiple===!0?"multiple":void 0,capture:l.capture,onMousedown:se,onClick:g,onChange:ae})}function pe(){return u.header!==void 0?u.header(Q):[m("div",{class:"q-uploader__header-content column"},[m("div",{class:"flex flex-center no-wrap q-gutter-xs"},[W(e.queuedFiles.value.length!==0,"removeQueue",Y),W(e.uploadedFiles.value.length!==0,"removeUploaded",x),e.isUploading.value===!0?m(ne,{class:"q-uploader__spinner"}):null,m("div",{class:"col column justify-center"},[l.label!==void 0?m("div",{class:"q-uploader__title"},[l.label]):null,m("div",{class:"q-uploader__subtitle"},[_.value+" / "+s.value])]),W(U.value,"add"),W(l.hideUploadBtn===!1&&r.value===!0,"upload",e.upload),W(e.isUploading.value,"clear",e.abort)])])]}function ve(){return u.list!==void 0?u.list(Q):e.files.value.map(a=>m("div",{key:a.__key,class:"q-uploader__file relative-position"+(l.noThumbnails!==!0&&a.__img!==void 0?" q-uploader__file--img":"")+(a.__status==="failed"?" q-uploader__file--failed":a.__status==="uploaded"?" q-uploader__file--uploaded":""),style:l.noThumbnails!==!0&&a.__img!==void 0?{backgroundImage:'url("'+a.__img.src+'")',backgroundSize:l.thumbnailFit}:null},[m("div",{class:"q-uploader__file-header row flex-center no-wrap"},[a.__status==="failed"?m(we,{class:"q-uploader__file-status",name:k.iconSet.type.negative,color:"negative"}):null,m("div",{class:"q-uploader__file-header-content col"},[m("div",{class:"q-uploader__title"},[a.name]),m("div",{class:"q-uploader__subtitle row items-center no-wrap"},[a.__sizeLabel+" / "+a.__progressLabel])]),a.__status==="uploading"?m(De,{value:a.__progress,min:0,max:1,indeterminate:a.__progress===0}):m(J,{round:!0,dense:!0,flat:!0,icon:k.iconSet.uploader[a.__status==="uploaded"?"done":"clear"],onClick:()=>{G(a)}})])]))}ye(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&Z()});const Q={};for(const a in e)ze(e[a])===!0?qe(Q,a,()=>e[a].value):Q[a]=e[a];return Object.assign(Q,{upload:te,reset:I,removeUploadedFiles:x,removeQueuedFiles:Y,removeFile:G,pickFiles:g,addFiles:S}),Se(Q,{canAddFiles:()=>U.value,canUpload:()=>r.value,uploadSizeLabel:()=>_.value,uploadProgressLabel:()=>s.value}),v({...e,upload:te,reset:I,removeUploadedFiles:x,removeQueuedFiles:Y,removeFile:G,pickFiles:g,addFiles:S,canAddFiles:U,canUpload:r,uploadSizeLabel:_,uploadProgressLabel:s}),()=>{const a=[m("div",{class:O.value},pe()),m("div",{class:"q-uploader__list scroll"},ve()),E("uploader")];e.isBusy.value===!0&&a.push(m("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[m(ne)]));const d={ref:R,class:A.value};return U.value===!0&&Object.assign(d,{onDragover:c,onDragleave:t}),m("div",d,a)}}const Ne=()=>!0;function Oe(n){const v={};return n.forEach(o=>{v[o]=Ne}),v}const Ie=Oe(ce);var Qe=({name:n,props:v,emits:o,injectPlugin:l})=>ke({name:n,props:{...je,...v},emits:xe(o)===!0?{...Ie,...o}:[...ce,...o],setup(u,{expose:p}){return Ae(l,p)}});function C(n){return typeof n=="function"?n:()=>n}const Me="QUploader",$e={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>n=>n.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},We=["factoryFailed","uploaded","failed","uploading"];function Ye({props:n,emit:v,helpers:o}){const l=F([]),u=F([]),p=F(0),b=q(()=>({url:C(n.url),method:C(n.method),headers:C(n.headers),formFields:C(n.formFields),fieldName:C(n.fieldName),withCredentials:C(n.withCredentials),sendRaw:C(n.sendRaw),batch:C(n.batch)})),k=q(()=>p.value>0),N=q(()=>u.value.length!==0);let D;function T(){l.value.forEach(e=>{e.abort()}),u.value.length!==0&&(D=!0)}function j(){const e=o.queuedFiles.value.slice(0);o.queuedFiles.value=[],b.value.batch(e)?R(e):e.forEach(g=>{R([g])})}function R(e){if(p.value++,typeof n.factory!="function"){P(e,{});return}const g=n.factory(e);if(!g)v("factoryFailed",new Error("QUploader: factory() does not return properly"),e),p.value--;else if(typeof g.catch=="function"&&typeof g.then=="function"){u.value.push(g);const S=c=>{o.isAlive()===!0&&(u.value=u.value.filter(t=>t!==g),u.value.length===0&&(D=!1),o.queuedFiles.value=o.queuedFiles.value.concat(e),e.forEach(t=>{o.updateFileStatus(t,"failed")}),v("factoryFailed",c,e),p.value--)};g.then(c=>{D===!0?S(new Error("Aborted")):o.isAlive()===!0&&(u.value=u.value.filter(t=>t!==g),P(e,c))}).catch(S)}else P(e,g||{})}function P(e,g){const S=new FormData,c=new XMLHttpRequest,t=(r,A)=>g[r]!==void 0?C(g[r])(A):b.value[r](A),y=t("url",e);if(!y){console.error("q-uploader: invalid or no URL specified"),p.value--;return}const E=t("formFields",e);E!==void 0&&E.forEach(r=>{S.append(r.name,r.value)});let L=0,i=0,f=0,w=0,s;c.upload.addEventListener("progress",r=>{if(s===!0)return;const A=Math.min(w,r.loaded);o.uploadedSize.value+=A-f,f=A;let O=f-i;for(let I=L;O>0&&I<e.length;I++){const x=e[I];if(O>x.size)O-=x.size,L++,i+=x.size,o.updateFileStatus(x,"uploading",x.size);else{o.updateFileStatus(x,"uploading",O);return}}},!1),c.onreadystatechange=()=>{c.readyState<4||(c.status&&c.status<400?(o.uploadedFiles.value=o.uploadedFiles.value.concat(e),e.forEach(r=>{o.updateFileStatus(r,"uploaded")}),v("uploaded",{files:e,xhr:c})):(s=!0,o.uploadedSize.value-=f,o.queuedFiles.value=o.queuedFiles.value.concat(e),e.forEach(r=>{o.updateFileStatus(r,"failed")}),v("failed",{files:e,xhr:c})),p.value--,l.value=l.value.filter(r=>r!==c))},c.open(t("method",e),y),t("withCredentials",e)===!0&&(c.withCredentials=!0);const _=t("headers",e);_!==void 0&&_.forEach(r=>{c.setRequestHeader(r.name,r.value)});const U=t("sendRaw",e);e.forEach(r=>{o.updateFileStatus(r,"uploading",0),U!==!0&&S.append(t("fieldName",r),r,r.name),r.xhr=c,r.__abort=()=>{c.abort()},w+=r.size}),v("uploading",{files:e,xhr:c}),l.value.push(c),U===!0?c.send(new Blob(e)):c.send(S)}return{isUploading:k,isBusy:N,abort:T,upload:j}}var He={name:Me,props:$e,emits:We,injectPlugin:Ye},Xe=Qe(He);const Ge={class:"row"},Ke={class:"col-md"},Je={class:"row"},Ve={class:"col-md q-pt-md"},ra={__name:"FotaPage",setup(n){const v=F([]),o=F(null),l=p=>{const b=p.target.files[0];b&&b.name.endsWith(".bin")?(v.value.push({name:b.name,size:(b.size/1024).toFixed(2)+" KB",uploadDate:new Date().toLocaleDateString("tr-TR"),file:b}),o.value=b,H.create({type:"positive",message:`${b.name} dosyas\u0131 y\xFCklendi.`})):H.create({type:"warning",message:"Yaln\u0131zca .bin dosyalar\u0131n\u0131 y\xFCkleyebilirsiniz!"})},u=()=>{if(!o.value){H.create({type:"warning",message:"T\xFCm cihazlara g\xF6ndermek i\xE7in bir .bin dosyas\u0131 y\xFCkleyin!"});return}H.create({type:"positive",message:`${o.value.name} dosyas\u0131 t\xFCm cihazlara g\xF6nderildi.`})};return(p,b)=>(Ue(),Be(Re,{padding:""},{default:Ce(()=>[b[0]||(b[0]=M("div",{class:"row"},[M("div",{class:"page-title"},"FOTA (Uzaktan yaz\u0131l\u0131m g\xFCncelleme)")],-1)),M("div",Ge,[M("div",Ke,[K(Xe,{label:".bin Dosyas\u0131 Y\xFCkleyin",accept:".bin",onAdded:l,"hide-upload-button":""}),K(J,{label:"Son FOTA Dosyas\u0131n\u0131 T\xFCm Cihazlara G\xF6nder",color:"primary",onClick:u,disable:!o.value,class:"q-mt-md"},null,8,["disable"])])]),M("div",Je,[M("div",Ve,[K(Te,{rows:v.value,columns:[{name:"name",label:"Dosya Ad\u0131",field:"name",align:"left"},{name:"size",label:"Dosya Boyutu",field:"size",align:"center"},{name:"uploadDate",label:"Y\xFCklenme Tarihi",field:"uploadDate",align:"center"}],"row-key":"name",title:"Y\xFCklenen FOTA Dosyalar\u0131","rows-per-page-options":"[5, 10, 20]"},null,8,["rows"])])])]),_:1}))}};export{ra as default};
